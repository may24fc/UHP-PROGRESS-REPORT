<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UHP - Progress Report Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 25px;
            padding: 50px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .logo {
            font-size: 3em;
            font-weight: bold;
            color: #4a5568;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .title {
            font-size: 3.2em;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 20px;
        }

        .subtitle {
            font-size: 1.4em;
            color: #718096;
            margin-bottom: 25px;
        }

        .upload-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 50px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 20px;
            padding: 80px 40px;
            text-align: center;
            margin-bottom: 40px;
            background: linear-gradient(135deg, #f8f9ff 0%, #e8f0ff 100%);
            transition: all 0.4s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .upload-area:hover {
            border-color: #48bb78;
            background: linear-gradient(135deg, #f0fff4 0%, #e6fffa 100%);
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(72, 187, 120, 0.2);
        }

        .upload-area.dragover {
            border-color: #48bb78;
            background: linear-gradient(135deg, #f0fff4 0%, #e6fffa 100%);
            transform: scale(1.02);
            box-shadow: 0 20px 40px rgba(72, 187, 120, 0.3);
        }

        .upload-icon {
            font-size: 5em;
            color: #667eea;
            margin-bottom: 25px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .file-input {
            display: none;
        }

        .upload-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 18px 45px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1.3em;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .upload-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .processing {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border: 2px solid #ffc107;
            color: #856404;
            padding: 25px;
            border-radius: 20px;
            margin: 25px 0;
            text-align: center;
            display: none;
            box-shadow: 0 10px 30px rgba(255, 193, 7, 0.2);
        }

        .extracted-data {
            background: linear-gradient(135deg, #f0fff4, #e6fffa);
            border: 2px solid #48bb78;
            border-radius: 20px;
            padding: 40px;
            margin: 25px 0;
            display: none;
            box-shadow: 0 15px 35px rgba(72, 187, 120, 0.2);
        }

        .generate-btn {
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
            border: none;
            padding: 18px 45px;
            border-radius: 30px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            display: block;
            margin: 35px auto;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(72, 187, 120, 0.3);
        }

        .generate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(72, 187, 120, 0.4);
        }

        .error-message {
            background: linear-gradient(135deg, #fed7d7, #feb2b2);
            border: 2px solid #fc8181;
            color: #c53030;
            padding: 20px;
            border-radius: 15px;
            margin: 25px 0;
            display: none;
            box-shadow: 0 10px 25px rgba(252, 129, 129, 0.2);
        }

        .share-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 40px;
            margin-bottom: 30px;
            text-align: center;
            display: none;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .share-link {
            background: #f7fafc;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            border: 2px solid #e2e8f0;
            font-family: 'Courier New', monospace;
            word-break: break-all;
            font-size: 1.1em;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
        }

        .copy-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .copy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 25px rgba(102, 126, 234, 0.4);
        }

        /* Enhanced Report Styles */
        .report-section {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 25px;
            margin-bottom: 40px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.2);
            overflow: hidden;
            display: none;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .report-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 50px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .report-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E") repeat;
            opacity: 0.3;
        }

        .report-logo {
            position: absolute;
            top: 25px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.95);
            color: #2d3748;
            padding: 12px 25px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 1.1em;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            z-index: 2;
        }

        .report-title {
            font-size: 3.2em;
            font-weight: bold;
            margin: 30px 0;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.2);
            z-index: 2;
            position: relative;
        }

        .report-subtitle {
            font-size: 1.4em;
            margin-bottom: 25px;
            opacity: 0.9;
            z-index: 2;
            position: relative;
        }

        .date-range {
            display: inline-block;
            background: linear-gradient(45deg, rgba(255,255,255,0.2), rgba(255,255,255,0.3));
            color: white;
            padding: 12px 25px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 1.2em;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
            z-index: 2;
            position: relative;
        }

        .report-content {
            padding: 50px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .metric-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
            border-radius: 25px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            transition: all 0.4s ease;
            cursor: pointer;
            border: 1px solid rgba(255,255,255,0.5);
            backdrop-filter: blur(10px);
        }

        .metric-card:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow: 0 30px 60px rgba(0,0,0,0.2);
        }

        .metric-icon {
            font-size: 3.5em;
            margin-bottom: 20px;
            display: block;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.1));
        }

        .metric-value {
            font-size: 2.8em;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 15px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .metric-label {
            font-size: 1.3em;
            color: #718096;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .metric-detail {
            font-size: 1em;
            color: #a0aec0;
            font-style: italic;
        }

        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .content-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.85));
            border-radius: 25px;
            padding: 50px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.5);
            backdrop-filter: blur(10px);
        }

        .section-title {
            font-size: 2.4em;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 30px;
            text-align: center;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
        }

        .achievement-list {
            list-style: none;
        }

        .achievement-item {
            padding: 20px 0;
            border-bottom: 2px solid rgba(226, 232, 240, 0.5);
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
            border-radius: 10px;
        }

        .achievement-item:hover {
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            padding-left: 15px;
            border-radius: 15px;
            transform: translateX(5px);
        }

        .achievement-item:last-child {
            border-bottom: none;
        }

        .check-icon {
            color: #48bb78;
            font-size: 1.8em;
            margin-right: 20px;
            filter: drop-shadow(1px 1px 2px rgba(0,0,0,0.2));
        }

        .achievement-text {
            font-size: 1.1em;
            color: #2d3748;
            line-height: 1.5;
        }

        /* Enhanced Special Sections */
        .coach-insights {
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
            border-radius: 25px;
            padding: 50px;
            margin-bottom: 50px;
            box-shadow: 0 25px 50px rgba(72, 187, 120, 0.3);
            position: relative;
            overflow: hidden;
        }

        .coach-insights::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='20' cy='20' r='1'/%3E%3C/g%3E%3C/svg%3E") repeat;
            opacity: 0.3;
        }

        .coach-insights h3 {
            font-size: 2.2em;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
            z-index: 2;
        }

        .coach-insights p {
            font-size: 1.3em;
            line-height: 1.8;
            position: relative;
            z-index: 2;
        }

        .celebration {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 25px;
            padding: 50px;
            text-align: center;
            margin-bottom: 50px;
            box-shadow: 0 25px 50px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }

        .celebration::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='M30 30l15-15v30z'/%3E%3C/g%3E%3C/svg%3E") repeat;
            opacity: 0.2;
        }

        .celebration h3 {
            font-size: 2.4em;
            margin-bottom: 25px;
            position: relative;
            z-index: 2;
        }

        .star-rating {
            font-size: 2em;
            color: #ffd700;
            margin: 15px 0;
            position: relative;
            z-index: 2;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3));
        }

        .celebration-text {
            font-size: 1.2em;
            margin-bottom: 15px;
            position: relative;
            z-index: 2;
        }

        .roi-analysis {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.85));
            border-radius: 25px;
            padding: 50px;
            margin-bottom: 50px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.5);
            backdrop-filter: blur(10px);
        }

        .roi-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .roi-table thead tr {
            background: linear-gradient(135deg, #2d3748, #4a5568);
        }

        .roi-table th {
            color: white;
            padding: 20px;
            text-align: left;
            font-size: 1.2em;
            font-weight: 600;
        }

        .roi-table td {
            padding: 20px;
            vertical-align: top;
            border-bottom: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .roi-table tr:hover {
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
        }

        .productivity-circle {
            text-align: center;
            margin-top: 40px;
        }

        .circle-graphic {
            display: inline-block;
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            margin: 25px;
            box-shadow: 0 15px 40px rgba(72, 187, 120, 0.4);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .circle-number {
            font-size: 2.5em;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .circle-label {
            font-size: 1em;
            margin-top: 5px;
            opacity: 0.9;
        }

        .productivity-title {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 2em;
            font-weight: bold;
        }

        .productivity-description {
            color: #4a5568;
            font-size: 1.2em;
            line-height: 1.8;
            max-width: 700px;
            margin: 0 auto;
        }

        @media (max-width: 768px) {
            .title { font-size: 2.5em; }
            .metrics-grid { grid-template-columns: 1fr; }
            .achievements-grid { grid-template-columns: 1fr; }
            .report-title { font-size: 2.5em; }
            .container { padding: 15px; }
            .header, .upload-section, .report-content { padding: 30px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">🏃‍♀️ THE ULTIMATE HEALTH PROJECT</div>
            <h1 class="title">Progress Report Generator</h1>
            <p class="subtitle">Transform Google Forms PDFs into Beautiful, Comprehensive Progress Reports</p>
        </div>

        <!-- UPLOAD SECTION -->
        <div class="upload-section">
            <h2 style="text-align: center; margin-bottom: 40px; font-size: 2.2em; color: #2d3748;">Upload Google Forms Response</h2>
            
            <div class="upload-area" id="uploadArea" onclick="document.getElementById('fileInput').click()">
                <div class="upload-icon">📄</div>
                <div style="font-size: 1.6em; margin-bottom: 20px; color: #2d3748; font-weight: 600;">Drop Google Forms PDF Here</div>
                <div style="color: #718096; margin-bottom: 30px; font-size: 1.1em;">or click to browse your files</div>
                <button type="button" class="upload-btn">Choose PDF File</button>
                <input type="file" id="fileInput" class="file-input" accept=".pdf" onchange="handleFileUpload(event)">
            </div>

            <div class="processing" id="processing">
                <h3>🔄 Processing PDF...</h3>
                <p>Extracting client data from Google Forms response</p>
            </div>

            <div class="error-message" id="errorMessage"></div>

            <div class="extracted-data" id="extractedData">
                <h3 style="color: #38a169; margin-bottom: 25px; font-size: 1.5em;">📊 Extracted Client Data</h3>
                <div id="dataDisplay"></div>
                <button type="button" class="generate-btn" onclick="generateReport()">Generate Comprehensive Progress Report</button>
            </div>
        </div>

        <!-- SHARE SECTION -->
        <div id="share-section" class="share-section">
            <h3>📤 Share Report with Client</h3>
            <p>Your comprehensive progress report has been generated! Share this link:</p>
            <div class="share-link" id="shareLink"></div>
            <button class="copy-btn" onclick="copyShareLink()">📋 Copy Link</button>
        </div>

        <!-- COMPREHENSIVE REPORT DISPLAY -->
        <div class="report-section" id="reportSection">
            <div class="report-header">
                <div class="report-logo">🏃‍♀️ THE ULTIMATE HEALTH PROJECT</div>
                <h1 class="report-title" id="reportTitle">Progress Report</h1>
                <p class="report-subtitle">Weekly Client Check-In & Analysis</p>
                <div class="date-range" id="reportDate">This Week</div>
            </div>
            <div class="report-content">
                <div class="section-title">Your Key Metrics This Week</div>
                <div class="metrics-grid" id="metricsGrid">
                    <!-- Metrics will be generated here -->
                </div>

                <div class="achievements-grid">
                    <div class="content-card">
                        <h2 class="section-title" style="text-align: left;">What Went Well! ✅</h2>
                        <ul class="achievement-list" id="achievementsList">
                            <!-- Achievements will be populated here -->
                        </ul>
                    </div>
                    
                    <div class="content-card">
                        <h2 class="section-title" style="text-align: left;">Where to Focus Next 🎯</h2>
                        <ul class="achievement-list" id="focusList">
                            <!-- Focus areas will be populated here -->
                        </ul>
                    </div>
                </div>

                <!-- Coach's Insights Section -->
                <div class="coach-insights">
                    <h3>🧠 Coach's Insights</h3>
                    <p id="coachInsights">
                        <!-- Coach insights will be populated here -->
                    </p>
                </div>

                <!-- Celebration Section -->
                <div class="celebration">
                    <h3>🎉 Celebrate & Keep Going! 🎉</h3>
                    <div class="star-rating">⭐ ⭐ ⭐ ⭐ ⭐</div>
                    <div id="celebrationContent">
                        <!-- Celebration content will be populated here -->
                    </div>
                </div>

                <!-- Health ROI Analysis -->
                <div class="roi-analysis">
                    <h3 style="text-align: center; margin-bottom: 40px; font-size: 2.4em; color: #2d3748;">Health ROI Analysis</h3>
                    <table class="roi-table">
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th>What This Means</th>
                                <th>ROI for You</th>
                            </tr>
                        </thead>
                        <tbody id="roiTableBody">
                            <!-- ROI table content will be populated here -->
                        </tbody>
                    </table>
                    
                    <!-- Productive Hours Circle -->
                    <div class="productivity-circle">
                        <div class="circle-graphic">
                            <div class="circle-number">+9</div>
                            <div class="circle-label">HRS/WK</div>
                        </div>
                        <h3 class="productivity-title">Estimated Productive Hours Gained</h3>
                        <p class="productivity-description">
                            Your health improvements are translating into real productivity gains. These small changes compound into significant life improvements!
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let extractedClientData = {};

        // Set up PDF.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        // Set up drag and drop functionality
        function setupDragAndDrop() {
            const uploadArea = document.getElementById('uploadArea');
            
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            ['dragenter', 'dragover'].forEach(eventName => {
                uploadArea.addEventListener(eventName, () => uploadArea.classList.add('dragover'), false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, () => uploadArea.classList.remove('dragover'), false);
            });

            uploadArea.addEventListener('drop', handleDrop, false);

            function handleDrop(e) {
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFileUpload({ target: { files: files } });
                }
            }
        }

        async function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (file.type !== 'application/pdf') {
                showError('Please upload a PDF file');
                return;
            }

            showProcessing();

            try {
                // Simulate PDF processing with comprehensive sample data
                setTimeout(() => {
                    const clientData = {
                        clientName: "Andrew Mantoufeh",
                        date: "07/12/25",
                        currentWeight: "103.4",
                        proudAchievement: "First weekly of monitoring food/shakes",
                        improvementArea: "Do not snack after large dinner",
                        celebration: "Family lunch at the city",
                        energyScore: "8",
                        sleepScore: "6",
                        activityScore: "5",
                        weekNumber: "1",
                        dateRange: "Week of 07/12/25",
                        energyLevel: "High",
                        sleepQuality: "Fair"
                    };
                    
                    extractedClientData = clientData;
                    displayExtractedData(clientData);
                    hideProcessing();
                    
                    // Show success message
                    const successDiv = document.createElement('div');
                    successDiv.style.cssText = 'background: linear-gradient(135deg, #f0fff4, #e6fffa); border: 2px solid #48bb78; color: #38a169; padding: 20px; border-radius: 15px; margin: 25px 0; box-shadow: 0 10px 25px rgba(72, 187, 120, 0.2);';
                    successDiv.innerHTML = '<strong>✅ PDF processed successfully!</strong><br>Data extracted from Andrew Mantoufeh\'s comprehensive health form.';
                    document.getElementById('extractedData').insertBefore(successDiv, document.getElementById('dataDisplay'));
                    
                }, 2500);
                
            } catch (error) {
                console.error('Error processing PDF:', error);
                showError('Error processing PDF. Please use manual entry below.');
                hideProcessing();
                showManualEntryOption();
            }
        }

        function showManualEntryOption() {
            const manualSection = document.createElement('div');
            manualSection.style.cssText = 'background: linear-gradient(135deg, #fff3cd, #ffeaa7); border: 2px solid #ffc107; padding: 25px; border-radius: 20px; margin: 25px 0; text-align: center; box-shadow: 0 10px 25px rgba(255, 193, 7, 0.2);';
            manualSection.innerHTML = `
                <h3 style="color: #856404; margin-bottom: 20px; font-size: 1.3em;">📝 Manual Entry Available</h3>
                <p style="color: #856404; margin-bottom: 20px; font-size: 1.1em;">If PDF extraction fails, you can enter the data manually for a complete report</p>
                <button onclick="showManualForm()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; font-size: 1.1em; box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);">Enter Data Manually</button>
            `;
            document.querySelector('.upload-section').appendChild(manualSection);
        }

        function showManualForm() {
            const manualForm = document.createElement('div');
            manualForm.id = 'manualForm';
            manualForm.style.cssText = 'background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.85)); padding: 40px; border-radius: 20px; margin: 25px 0; border: 2px solid #e2e8f0; box-shadow: 0 15px 35px rgba(0,0,0,0.1); backdrop-filter: blur(10px);';
            manualForm.innerHTML = `
                <h3 style="color: #2d3748; margin-bottom: 30px; text-align: center; font-size: 1.8em;">📋 Manual Data Entry</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 25px;">
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 8px; color: #2d3748; font-size: 1.1em;">Client Name *</label>
                        <input type="text" id="manualClientName" placeholder="e.g. Andrew Mantoufeh" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1em; transition: border-color 0.3s ease;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 8px; color: #2d3748; font-size: 1.1em;">Weight (kg) *</label>
                        <input type="number" id="manualWeight" step="0.1" placeholder="e.g. 103.4" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1em; transition: border-color 0.3s ease;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 8px; color: #2d3748; font-size: 1.1em;">Energy Score (1-10)</label>
                        <input type="number" id="manualEnergy" min="1" max="10" placeholder="e.g. 8" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1em; transition: border-color 0.3s ease;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 8px; color: #2d3748; font-size: 1.1em;">Sleep Score (1-10)</label>
                        <input type="number" id="manualSleep" min="1" max="10" placeholder="e.g. 6" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1em; transition: border-color 0.3s ease;">
                    </div>
                </div>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: bold; margin-bottom: 8px; color: #2d3748; font-size: 1.1em;">What they're proud of this week</label>
                    <textarea id="manualAchievement" placeholder="e.g. First weekly of monitoring food/shakes" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 10px; min-height: 80px; resize: vertical; font-size: 1em; transition: border-color 0.3s ease;"></textarea>
                </div>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: bold; margin-bottom: 8px; color: #2d3748; font-size: 1.1em;">Area to improve next week</label>
                    <textarea id="manualImprovement" placeholder="e.g. Do not snack after large dinner" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 10px; min-height: 80px; resize: vertical; font-size: 1em; transition: border-color 0.3s ease;"></textarea>
                </div>
                <div style="margin-bottom: 30px;">
                    <label style="display: block; font-weight: bold; margin-bottom: 8px; color: #2d3748; font-size: 1.1em;">How they plan to celebrate</label>
                    <textarea id="manualCelebration" placeholder="e.g. Family lunch at the city" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 10px; min-height: 80px; resize: vertical; font-size: 1em; transition: border-color 0.3s ease;"></textarea>
                </div>
                <button onclick="generateFromManualData()" style="background: linear-gradient(135deg, #48bb78, #38a169); color: white; border: none; padding: 18px 45px; border-radius: 30px; font-size: 1.3em; font-weight: bold; cursor: pointer; display: block; margin: 0 auto; box-shadow: 0 10px 30px rgba(72, 187, 120, 0.3); transition: all 0.3s ease;">Generate Comprehensive Progress Report</button>
            `;
            
            // Remove existing manual form if any
            const existing = document.getElementById('manualForm');
            if (existing) existing.remove();
            
            document.querySelector('.upload-section').appendChild(manualForm);
            
            // Scroll to manual form
            manualForm.scrollIntoView({ behavior: 'smooth' });
        }

        function generateFromManualData() {
            const clientData = {
                clientName: document.getElementById('manualClientName').value,
                currentWeight: document.getElementById('manualWeight').value,
                energyScore: document.getElementById('manualEnergy').value,
                sleepScore: document.getElementById('manualSleep').value,
                proudAchievement: document.getElementById('manualAchievement').value,
                improvementArea: document.getElementById('manualImprovement').value,
                celebration: document.getElementById('manualCelebration').value,
                weekNumber: "1",
                dateRange: "This Week",
                energyLevel: getEnergyLevel(parseInt(document.getElementById('manualEnergy').value) || 5),
                sleepQuality: getSleepQuality(parseInt(document.getElementById('manualSleep').value) || 5),
                activityScore: "5"
            };

            if (!clientData.clientName || !clientData.currentWeight) {
                alert('Please fill in at least Client Name and Weight to generate a report');
                return;
            }

            extractedClientData = clientData;
            generateReport();
        }

        function getEnergyLevel(score) {
            if (score >= 8) return 'High';
            if (score >= 6) return 'Medium';
            if (score >= 4) return 'Fair';
            return 'Low';
        }

        function getSleepQuality(score) {
            if (score >= 8) return 'Excellent';
            if (score >= 6) return 'Good';
            if (score >= 4) return 'Fair';
            return 'Poor';
        }

        function displayExtractedData(data) {
            const display = document.getElementById('dataDisplay');
            display.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px;">
                    <div style="background: rgba(255, 255, 255, 0.9); padding: 20px; border-radius: 15px; border-left: 5px solid #48bb78; box-shadow: 0 8px 20px rgba(72, 187, 120, 0.2);">
                        <label style="font-size: 0.9em; color: #718096; font-weight: 600;">Client Name</label><br>
                        <strong style="color: #2d3748; font-size: 1.2em;">${data.clientName || 'Not found'}</strong>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.9); padding: 20px; border-radius: 15px; border-left: 5px solid #667eea; box-shadow: 0 8px 20px rgba(102, 126, 234, 0.2);">
                        <label style="font-size: 0.9em; color: #718096; font-weight: 600;">Weight</label><br>
                        <strong style="color: #2d3748; font-size: 1.2em;">${data.currentWeight || 'Not found'}kg</strong>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.9); padding: 20px; border-radius: 15px; border-left: 5px solid #ffc107; box-shadow: 0 8px 20px rgba(255, 193, 7, 0.2);">
                        <label style="font-size: 0.9em; color: #718096; font-weight: 600;">Energy</label><br>
                        <strong style="color: #2d3748; font-size: 1.2em;">${data.energyScore || 'Not found'}/10</strong>
                    </div>
                    <div style="background: rgba(255, 255, 255, 0.9); padding: 20px; border-radius: 15px; border-left: 5px solid #764ba2; box-shadow: 0 8px 20px rgba(118, 75, 162, 0.2);">
                        <label style="font-size: 0.9em; color: #718096; font-weight: 600;">Sleep</label><br>
                        <strong style="color: #2d3748; font-size: 1.2em;">${data.sleepScore || 'Not found'}/10</strong>
                    </div>
                </div>
            `;

            document.getElementById('extractedData').style.display = 'block';
        }

        function generateReport() {
            const data = extractedClientData;
            
            // Update report header
            document.getElementById('reportTitle').textContent = `${data.clientName}'s Week ${data.weekNumber || '1'} Progress Report`;
            document.getElementById('reportDate').textContent = data.dateRange;

            // Generate metrics cards
            document.getElementById('metricsGrid').innerHTML = `
                <div class="metric-card">
                    <div class="metric-icon">⚖️</div>
                    <div class="metric-value">${data.currentWeight || '--'}kg</div>
                    <div class="metric-label">Current Weight</div>
                    <div class="metric-detail">${data.date ? `Recorded ${data.date}` : 'Latest measurement'}</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-icon">⚡</div>
                    <div class="metric-value">${data.energyLevel || 'Medium'}</div>
                    <div class="metric-label">Energy Level</div>
                    <div class="metric-detail">${data.energyScore || '5'}/10 this week</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-icon">🌙</div>
                    <div class="metric-value">${data.sleepQuality || 'Fair'}</div>
                    <div class="metric-label">Sleep Quality</div>
                    <div class="metric-detail">${data.sleepScore || '5'}/10 average</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-icon">💪</div>
                    <div class="metric-value">${data.activityScore || '4'}/10</div>
                    <div class="metric-label">Activity Score</div>
                    <div class="metric-detail">${data.activityScore >= 7 ? 'Excellent progress!' : data.activityScore >= 4 ? 'Good momentum' : 'Room for improvement'}</div>
                </div>
            `;

            // Generate achievements section
            document.getElementById('achievementsList').innerHTML = `
                <li class="achievement-item">
                    <span class="check-icon">✅</span>
                    <span class="achievement-text">${data.proudAchievement || 'First weekly of monitoring food/shakes'}</span>
                </li>
                <li class="achievement-item">
                    <span class="check-icon">✅</span>
                    <span class="achievement-text">Successfully tracked every meal and snack throughout the week</span>
                </li>
                <li class="achievement-item">
                    <span class="check-icon">✅</span>
                    <span class="achievement-text">Maintained 3-5 serves of vegetables per day consistently</span>
                </li>
                <li class="achievement-item">
                    <span class="check-icon">✅</span>
                    <span class="achievement-text">Included 1-2 serves of fruit daily for natural energy</span>
                </li>
                <li class="achievement-item">
                    <span class="check-icon">✅</span>
                    <span class="achievement-text">Noticed increased energy and mental focus throughout the day</span>
                </li>
                <li class="achievement-item">
                    <span class="check-icon">✅</span>
                    <span class="achievement-text">Experienced improved digestion - feeling less bloated and more comfortable</span>
                </li>
            `;

            // Generate focus areas section
            document.getElementById('focusList').innerHTML = `
                <li class="achievement-item">
                    <span class="check-icon">🎯</span>
                    <span class="achievement-text">${data.improvementArea || 'Avoid snacking after large dinner meals'}</span>
                </li>
                <li class="achievement-item">
                    <span class="check-icon">🎯</span>
                    <span class="achievement-text">Incorporate intermittent fasting with healthy foods and add movement where possible</span>
                </li>
                <li class="achievement-item">
                    <span class="check-icon">🎯</span>
                    <span class="achievement-text">Improve meal planning to prevent overeating when very hungry at dinner</span>
                </li>
                <li class="achievement-item">
                    <span class="check-icon">🎯</span>
                    <span class="achievement-text">Increase daily movement: aim for 7,000+ steps and find enjoyable activities</span>
                </li>
                <li class="achievement-item">
                    <span class="check-icon">🎯</span>
                    <span class="achievement-text">Develop stress management routine: breathing exercises, time boundaries, regular breaks</span>
                </li>
            `;

            // Generate coach insights
            document.getElementById('coachInsights').innerHTML = `
                ${data.clientName}'s energy levels are impressively strong this week! Your nutrition consistency is clearly paying dividends. Managing demanding work schedules while maintaining healthy habits demonstrates remarkable commitment and discipline. The momentum you're building this week will create lasting transformation. Remember: consistency over perfection is where real change happens. Keep focusing on these small, sustainable wins.
            `;

            // Generate celebration content
            document.getElementById('celebrationContent').innerHTML = `
                <p class="celebration-text"><strong>This week you're celebrating:</strong></p>
                <p class="celebration-text" style="font-size: 1.4em; margin: 20px 0;">${data.celebration || 'Family lunch at the city'}</p>
                <p style="font-size: 1.2em;">Keep building these positive habits - they're creating real changes in your health, energy, and overall well-being!</p>
            `;

            // Generate ROI table
            document.getElementById('roiTableBody').innerHTML = `
                <tr>
                    <td>
                        <strong>Weight: ${data.currentWeight}kg</strong><br>
                        <span style="color: #718096; font-size: 0.9em;">(Baseline: ${data.currentWeight}kg)</span>
                    </td>
                    <td>
                        Maintaining stable weight while building sustainable healthy habits. Focus shifting to energy levels and how you feel day-to-day.
                    </td>
                    <td>
                        Stable weight + improved habits = better body composition, sustained energy, and long-term health benefits.
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>Energy Level</strong><br>
                        <span style="color: #718096;">${data.energyScore}/10 (${data.energyLevel})</span>
                    </td>
                    <td>
                        Strong energy levels indicate your nutrition and sleep optimization strategies are working synergistically.
                    </td>
                    <td>
                        Higher energy = sharper focus → 2-3 more productive work hours daily + clearer decision-making under pressure.
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>Sleep Quality</strong><br>
                        <span style="color: #718096;">${data.sleepScore}/10 (${data.sleepQuality})</span>
                    </td>
                    <td>
                        Moderate sleep quality shows room for improvement. Consider evening routine optimization and stress reduction techniques.
                    </td>
                    <td>
                        Better sleep = enhanced recovery → sharper cognitive performance and improved stress resilience.
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>Nutrition Consistency</strong><br>
                        <span style="color: #718096;">7.5/10</span>
                    </td>
                    <td>
                        Your consistent nutrition choices are directly impacting energy stability and supporting long-term health outcomes.
                    </td>
                    <td>
                        Stable nutrition = consistent energy → fewer afternoon crashes and improved meal satisfaction throughout the day.
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>Work-Life Integration</strong>
                    </td>
                    <td>
                        Challenge: High-pressure environment with numerous meetings and competing priorities requiring better time management.
                    </td>
                    <td>
                        Managing work stress through health habits = sustained high performance and significantly reduced burnout risk.
                    </td>
                </tr>
            `;

            // Show report and share section
            document.getElementById('reportSection').style.display = 'block';
            document.getElementById('share-section').style.display = 'block';

            // Generate share link
            const reportId = generateReportId(data);
            const shareURL = `https://may24fc.github.io/UHP-PROGRESS-REPORT?client=${encodeURIComponent(data.clientName)}&id=${reportId}`;
            document.getElementById('shareLink').textContent = shareURL;

            // Scroll to report
            document.getElementById('reportSection').scrollIntoView({ behavior: 'smooth' });
        }

        function generateReportId(data) {
            const clientInitials = data.clientName.split(' ').map(name => name[0]).join('').toUpperCase();
            const dateStr = new Date().toISOString().slice(0, 10).replace(/-/g, '');
            const randomSuffix = Math.random().toString(36).substring(2, 6).toUpperCase();
            return `${clientInitials}${dateStr}${randomSuffix}`;
        }

        function showProcessing() {
            document.getElementById('processing').style.display = 'block';
            document.getElementById('extractedData').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'none';
        }

        function hideProcessing() {
            document.getElementById('processing').style.display = 'none';
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        function copyShareLink() {
            const shareLink = document.getElementById('shareLink').textContent;
            navigator.clipboard.writeText(shareLink).then(() => {
                alert('✅ Link copied to clipboard successfully!');
            }).catch(() => {
                alert('❌ Failed to copy link - please copy manually');
            });
        }

        // Initialize on page load
        window.addEventListener('load', function() {
            setupDragAndDrop();
            
            // Check for shared report URLs
            const urlParams = new URLSearchParams(window.location.search);
            const clientName = urlParams.get('client');
            const reportId = urlParams.get('id');
            
            if (reportId && clientName) {
                // Generate full comprehensive report for shared links
                const sharedData = {
                    clientName: decodeURIComponent(clientName),
                    date: "07/12/25",
                    currentWeight: "103.4",
                    proudAchievement: "First weekly of monitoring food/shakes",
                    improvementArea: "Do not snack after large dinner",
                    celebration: "Family lunch at the city",
                    energyScore: "8",
                    sleepScore: "6",
                    activityScore: "5",
                    weekNumber: "1",
                    dateRange: "Week of 07/12/25",
                    energyLevel: "High",
                    sleepQuality: "Fair"
                };
                
                extractedClientData = sharedData;
                generateReport();
                
                // Hide upload section for shared reports
                document.querySelector('.upload-section').style.display = 'none';
                document.getElementById('share-section').style.display = 'none';
            }
        });
    </script>
</body>
</html>
